<!DOCTYPE html>
<html>
<head>
    <title>Dynamic Form</title>
    <link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet'>
     <link rel="stylesheet" href="assets/css/style-form.css">
<body>
    <form id="dynamic-form"  action="display-quote.html">
        <h1>Quote Generator v3</h1>
        <h2>Client Information</h2>
        <div class="input-group">
            <label for="client-name">Client Name</label><br>
            <input type="text" id="client-name" name="client-name" placeholder="John Smith" autofocus><br>

            <label for="address">Client Address</label><br>
            <input type="text" id="address" name="address" placeholder="1234 Streetname Ave, City"><br>

            <label for="phone">Client Phone number</label><br>
            <input type="tel" id="phone" name="phone" placeholder="123-456-7890"><br>

            <label for="reference">Quote Reference</label><br>
            <div style="display: flex; align-items: center;">
                <input type="text" id="reference" name="reference" placeholder="Client-reference" style="flex-grow: 1;">
                <button type="button" onclick="generateReference()" style="margin-left: 10px;">Generate Reference</button>
            </div>

            <label for="customer-name">Customer Name</label><br>
            <div style="display: flex; align-items: center;">
                <input type="text" id="customer-name" name="customer-name" placeholder="John Smith" style="flex-grow: 1;">
                <button type="button" onclick="generateCustomer()" style="margin-left: 10px;">Same as Client</button>
            </div>
        </div><br>
        </div>
        <h2>Quote Comments</h2>
        <div id="comment-fields">
            <div class="input-group">
                <label for="comment">Comments:</label><br>
                <input type="text" id="comment" name="comment" placeholder="Quote Comments"><br>
            </div>
        </div>

        <button type="button" onclick="addComment()">Add Comment</button>   <button type="button" onclick="removeComment()">Remove Comment</button><br>

        <h2>Quote Costs</h2>
        <div id="cost-fields">
            <div class="input-group">
                <label for="cost-description">Costs:</label><br>
                <input type="text" id="cost-description" name="cost-description" placeholder="Item Description"><br><br>
                <input type="number" step="0.01" id="cost-amount" name="cost-amount" placeholder="123.45"><br>
            </div>
        </div>

        <button type="button" onclick="addCost()">Add Cost</button>
        <button type="button" onclick="removeCost()">Remove Cost</button><br>

        <input type="submit" value="Submit" onclick="window.location.href='display-quote.html'">
    </form>

    <script>
        function addComment() {
            var container = document.getElementById('comment-fields');
            var div = document.createElement('div');
            div.className = 'input-group';
            div.innerHTML = '<input type="text" id="comment" name="comment" placeholder="Quote Comments"><br>';
            container.appendChild(div);
        }

        function removeComment() {
            var container = document.getElementById('comment-fields');
            if (container.children.length > 1) {
                container.removeChild(container.lastChild);
            }
        }

        function addCost() {
            var container = document.getElementById('cost-fields');
            var div = document.createElement('div');
            div.className = 'input-group';
            div.innerHTML = '<input type="text" id="cost-description" name="cost-description" placeholder="Item Description"><br><br><input type="number" step="0.01" id="cost-amount" name="cost-amount" placeholder="123.45"><br>';
            container.appendChild(div);
        }

        function removeCost() {
            var container = document.getElementById('cost-fields');
            if (container.children.length > 1) {
                container.removeChild(container.lastChild);
            }
        }

        document.getElementById('dynamic-form').addEventListener('submit', function(event) {
        event.preventDefault();

        var formData = new FormData(event.target);
        var dataObject = {};

        for (var pair of formData.entries()) {
            if (pair[0] === 'comment' || pair[0] === 'cost-description' || pair[0] === 'cost-amount') {
                if (!dataObject[pair[0]]) {
                    dataObject[pair[0]] = [];
                }
                dataObject[pair[0]].push(pair[1]);
            } else {
                dataObject[pair[0]] = pair[1];
            }
        }

        localStorage.setItem('quoteObject', JSON.stringify(dataObject));
    });

    function generateCustomer() {
        var clientName = document.getElementById('client-name').value;
        document.getElementById('customer-name').value = clientName;
    }

    function generateReference() {
        var clientName = document.getElementById('client-name').value.split(' ')[0];
        var address = document.getElementById('address').value.split(' ')[1];
        var date = new Date();
        var month = date.getMonth() + 1;
        var year = date.getFullYear();
        // document.getElementById('reference').value = clientName + '-' + address + '-' + month + '-' + year; // adds date info to reference
        document.getElementById('reference').value = clientName + '-' + address;
    }

    </script>
</body>
</html>

